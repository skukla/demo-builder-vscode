{
  "$schema": "./components.schema.json",
  "version": "2.0.0",
  "infrastructure": {
    "adobe-cli": {
      "name": "Adobe I/O CLI & SDK",
      "description": "Command-line interface and SDK for Adobe I/O services"
    }
  },
  "selectionGroups": {
    "frontends": ["citisignal-nextjs", "eds-citisignal-storefront"],
    "backends": ["adobe-commerce-paas", "adobe-commerce-accs"],
    "dependencies": ["commerce-mesh", "demo-inspector"],
    "appBuilderApps": ["integration-service"],
    "integrations": ["experience-platform"],
    "addons": ["adobe-commerce-aco"],
    "tools": ["commerce-demo-ingestion"]
  },
  "components": {
    "citisignal-nextjs": {
      "name": "Headless CitiSignal",
      "description": "NextJS-based storefront with Adobe mesh integration",
      "icon": {
        "light": "nextjs-file-icon-light.svg",
        "dark": "nextjs-file-icon-dark.svg"
      },
      "version": "latest",
      "source": {
        "type": "git",
        "url": "https://github.com/skukla/citisignal-nextjs",
        "branch": "master",
        "gitOptions": {
          "shallow": false,
          "recursive": false
        }
      },
      "dependencies": {
        "required": ["commerce-mesh"]
      },
      "submodules": {
        "demo-inspector": {
          "path": "src/demo-inspector",
          "repository": "skukla/demo-inspector"
        }
      },
      "compatibleBackends": ["adobe-commerce-paas", "adobe-commerce-accs"],
      "configuration": {
        "nodeVersion": "24",
        "requiredEnvVars": [
          "MESH_ENDPOINT",
          "ADOBE_COMMERCE_URL",
          "ADOBE_COMMERCE_ENVIRONMENT_ID",
          "ADOBE_COMMERCE_STORE_VIEW_CODE",
          "ADOBE_COMMERCE_WEBSITE_CODE",
          "ADOBE_COMMERCE_STORE_CODE",
          "ADOBE_CATALOG_API_KEY"
        ],
        "optionalEnvVars": ["ADOBE_ASSETS_URL", "ADOBE_COMMERCE_CUSTOMER_GROUP"]
      }
    },
    "eds-citisignal-storefront": {
      "name": "CitiSignal EDS Storefront",
      "description": "Edge Delivery Services storefront with Commerce Drop-in components",
      "icon": {
        "light": "eds-file-icon-light.svg",
        "dark": "eds-file-icon-dark.svg"
      },
      "version": "latest",
      "source": {
        "type": "git",
        "url": "https://github.com/skukla/citisignal-one",
        "branch": "main",
        "gitOptions": {
          "shallow": true,
          "recursive": false
        }
      },
      "dependencies": {
        "required": [],
        "optional": ["demo-inspector"]
      },
      "compatibleBackends": ["adobe-commerce-paas", "adobe-commerce-accs"],
      "configuration": {
        "nodeVersion": "20",
        "requiredEnvVars": [
          "COMMERCE_ENDPOINT",
          "COMMERCE_STORE_CODE",
          "COMMERCE_STORE_VIEW_CODE",
          "COMMERCE_WEBSITE_CODE",
          "COMMERCE_API_KEY",
          "COMMERCE_ENVIRONMENT_ID"
        ],
        "optionalEnvVars": [
          "COMMERCE_CUSTOMER_GROUP"
        ]
      }
    },
    "adobe-commerce-paas": {
      "name": "Adobe Commerce PaaS",
      "description": "Adobe Commerce DSN instance",
      "configuration": {
        "nodeVersion": "20",
        "requiredServices": ["catalog-service", "live-search"],
        "requiredEnvVars": [
          "ADOBE_COMMERCE_URL",
          "ADOBE_COMMERCE_GRAPHQL_ENDPOINT",
          "ADOBE_COMMERCE_WEBSITE_CODE",
          "ADOBE_COMMERCE_STORE_CODE",
          "ADOBE_COMMERCE_STORE_VIEW_CODE",
          "ADOBE_COMMERCE_ENVIRONMENT_ID",
          "ADOBE_CATALOG_API_KEY"
        ],
        "optionalEnvVars": [
          "ADOBE_COMMERCE_CUSTOMER_GROUP",
          "ADOBE_ASSETS_URL"
        ]
      }
    },
    "adobe-commerce-accs": {
      "name": "Adobe Commerce Cloud Service",
      "description": "Adobe's managed SaaS commerce backend",
      "configuration": {
        "nodeVersion": "20",
        "requiredEnvVars": [
          "ACCS_HOST",
          "ACCS_STORE_VIEW_CODE"
        ],
        "optionalEnvVars": [
          "ACCS_CUSTOMER_GROUP"
        ]
      }
    },
    "adobe-commerce-aco": {
      "name": "Adobe Commerce Optimizer",
      "description": "Catalog optimization service for enhanced product discovery and merchandising",
      "addonFor": ["adobe-commerce-paas", "adobe-commerce-accs"],
      "configuration": {
        "requiredEnvVars": [
          "ACO_API_URL",
          "ACO_API_KEY",
          "ACO_TENANT_ID",
          "ACO_ENVIRONMENT_ID"
        ]
      }
    },
    "demo-inspector": {
      "name": "Demo Inspector",
      "description": "Interactive inspector overlay for demos",
      "subType": "inspector",
      "icon": "eye"
    },
    "commerce-mesh": {
      "name": "Adobe Commerce API Mesh",
      "description": "GraphQL gateway for unifying commerce data sources",
      "icon": {
        "light": "adobe-file-icon-light.svg",
        "dark": "adobe-file-icon-dark.svg"
      },
      "source": {
        "type": "git",
        "url": "https://github.com/skukla/commerce-mesh",
        "branch": "master",
        "gitOptions": {
          "shallow": true
        }
      },
      "configuration": {
        "nodeVersion": "20",
        "buildScript": "build",
        "requiresDeployment": true,
        "deploymentTarget": "adobe-io",
        "requiredEnvVars": [
          "ADOBE_COMMERCE_GRAPHQL_ENDPOINT",
          "ADOBE_CATALOG_SERVICE_ENDPOINT",
          "ADOBE_COMMERCE_URL",
          "ADOBE_COMMERCE_ENVIRONMENT_ID",
          "ADOBE_COMMERCE_STORE_VIEW_CODE",
          "ADOBE_COMMERCE_WEBSITE_CODE",
          "ADOBE_COMMERCE_STORE_CODE",
          "ADOBE_CATALOG_API_KEY"
        ],
        "providesEnvVars": ["MESH_ENDPOINT"]
      }
    },
    "experience-platform": {
      "name": "Experience Platform",
      "description": "Adobe Experience Platform integration via Commerce Data Sharing",
      "requiresApiKey": true,
      "endpoint": "https://platform.adobe.io",
      "configuration": {
        "requiredEnvVars": [
          "EXPERIENCE_PLATFORM_DATASTREAM_ID",
          "EXPERIENCE_PLATFORM_API_KEY"
        ]
      }
    },
    "integration-service": {
      "name": "Kukla Integration Service",
      "description": "Custom integration service for Target Product Recommendations, AEM Assets, and more",
      "icon": {
        "light": "adobe-file-icon-light.svg",
        "dark": "adobe-file-icon-dark.svg"
      },
      "source": {
        "type": "git",
        "url": "https://github.com/skukla/kukla-integration-service",
        "gitOptions": {
          "shallow": true
        }
      },
      "requiresDeployment": true,
      "configuration": {
        "runtime": "nodejs:22",
        "nodeVersion": "22",
        "actions": [
          "browse-files",
          "get-products",
          "download-file",
          "delete-file"
        ],
        "requiredEnvVars": [
          "ADOBE_COMMERCE_URL",
          "ADOBE_COMMERCE_ADMIN_USERNAME",
          "ADOBE_COMMERCE_ADMIN_PASSWORD",
          "ADOBE_COMMERCE_ENVIRONMENT_ID",
          "ADOBE_COMMERCE_STORE_VIEW_CODE",
          "ADOBE_COMMERCE_WEBSITE_CODE",
          "ADOBE_COMMERCE_STORE_CODE"
        ],
        "optionalEnvVars": ["AWS_ACCESS_KEY_ID", "AWS_SECRET_ACCESS_KEY"]
      }
    },
    "commerce-demo-ingestion": {
      "name": "Commerce Demo Ingestion",
      "description": "Tool for populating ACCS instances with demo data",
      "category": "tools",
      "hidden": true,
      "source": {
        "type": "git",
        "url": "https://github.com/PMET-public/commerce-demo-ingestion",
        "branch": "main",
        "gitOptions": {
          "shallow": true
        }
      },
      "dataRepository": {
        "url": "https://github.com/PMET-public/vertical-data-citisignal",
        "branch": "accs"
      },
      "installPath": "~/.demo-builder/tools/commerce-demo-ingestion",
      "configuration": {
        "nodeVersion": "18",
        "requiredEnvVars": [
          "ACO_API_URL",
          "ACO_API_KEY",
          "ACO_TENANT_ID",
          "ACO_ENVIRONMENT_ID"
        ],
        "scripts": {
          "import": "npm run import:aco",
          "cleanup": "npm run delete:aco"
        }
      }
    }
  },
  "services": {
    "catalog-service": {
      "name": "Catalog Service",
      "description": "Enhanced product information management",
      "requiredEnvVars": [
        "ADOBE_CATALOG_SERVICE_ENDPOINT",
        "ADOBE_COMMERCE_ENVIRONMENT_ID",
        "ADOBE_CATALOG_API_KEY"
      ]
    },
    "live-search": {
      "name": "Live Search",
      "description": "AI-powered search with personalization",
      "requiredEnvVars": [
        "ADOBE_CATALOG_SERVICE_ENDPOINT",
        "ADOBE_COMMERCE_ENVIRONMENT_ID",
        "ADOBE_CATALOG_API_KEY"
      ]
    }
  },
  "envVars": {
    "ACCS_HOST": {
      "label": "ACCS Host URL",
      "type": "url",
      "required": true,
      "placeholder": "https://your-instance.adobecommerce.com",
      "description": "The base URL of your Adobe Commerce Cloud Service instance",
      "group": "accs"
    },
    "ACCS_STORE_VIEW_CODE": {
      "label": "Store View Code",
      "type": "text",
      "required": true,
      "placeholder": "default",
      "description": "The store view code for your ACCS instance",
      "group": "accs"
    },
    "ACCS_CUSTOMER_GROUP": {
      "label": "Customer Group",
      "type": "text",
      "required": false,
      "default": "b6589fc6ab0dc82cf12099d1c2d40ab994e8410c",
      "description": "Customer group hash for pricing. Default is 'Not Logged In' group",
      "group": "accs"
    },
    "COMMERCE_ENDPOINT": {
      "label": "Commerce GraphQL Endpoint",
      "type": "url",
      "required": true,
      "placeholder": "https://edge-sandbox-graph.adobe.io/api/your-mesh-id/graphql",
      "description": "The GraphQL endpoint URL for your Commerce backend (usually your deployed API Mesh URL)",
      "group": "eds-commerce"
    },
    "COMMERCE_STORE_CODE": {
      "label": "Store Code",
      "type": "text",
      "required": true,
      "placeholder": "main_website_store",
      "default": "main_website_store",
      "description": "The Magento store code (e.g., 'main_website_store' or 'citisignal_store')",
      "group": "eds-commerce"
    },
    "COMMERCE_STORE_VIEW_CODE": {
      "label": "Store View Code",
      "type": "text",
      "required": true,
      "placeholder": "default",
      "default": "default",
      "description": "The store view code (e.g., 'default' or 'citisignal_us')",
      "group": "eds-commerce"
    },
    "COMMERCE_WEBSITE_CODE": {
      "label": "Website Code",
      "type": "text",
      "required": true,
      "placeholder": "base",
      "default": "base",
      "description": "The website code (e.g., 'base' or 'citisignal')",
      "group": "eds-commerce"
    },
    "COMMERCE_API_KEY": {
      "label": "Catalog API Key",
      "type": "text",
      "required": true,
      "placeholder": "your-catalog-api-key",
      "description": "Your Commerce Catalog Service API key (found in Magento Marketplace API Portal)",
      "group": "eds-commerce"
    },
    "COMMERCE_ENVIRONMENT_ID": {
      "label": "Environment ID",
      "type": "text",
      "required": true,
      "placeholder": "your-environment-id",
      "description": "Your Commerce SaaS environment/dataspace ID (found in Commerce Admin > Services Connector)",
      "group": "eds-commerce"
    },
    "COMMERCE_CUSTOMER_GROUP": {
      "label": "Customer Group",
      "type": "text",
      "required": false,
      "default": "b6589fc6ab0dc82cf12099d1c2d40ab994e8410c",
      "description": "Customer group hash for pricing. Default is 'Not Logged In' group",
      "group": "eds-commerce"
    },
    "MESH_ENDPOINT": {
      "label": "Mesh Query URL",
      "type": "url",
      "required": true,
      "placeholder": "https://edge-sandbox-graph.adobe.io/api/your-mesh-id/graphql",
      "description": "Automatically supplied after API Mesh deployment",
      "group": "mesh"
    },
    "ADOBE_ASSETS_URL": {
      "label": "Adobe Assets URL",
      "type": "url",
      "required": false,
      "placeholder": "https://delivery-p57319-e1619941.adobeaemcloud.com",
      "description": "Supply if the storefront should load assets from AEM",
      "group": "adobe-assets"
    },
    "ADOBE_CATALOG_API_KEY": {
      "label": "Sandbox Catalog API Key",
      "type": "text",
      "required": true,
      "placeholder": "your-sandbox-catalog-api-key",
      "description": "Found in the Magento Marketplace API Portal under Sandbox environment",
      "help": {
        "title": "Finding Your Catalog API Key",
        "steps": [
          {
            "text": "Go to `https://account.magento.com` and click API Portal in the left navigation",
            "screenshot": "help/catalog-api-key-step-1.png",
            "screenshotAlt": "Magento account page with API Portal highlighted"
          },
          {
            "text": "Switch the Environment dropdown to Sandbox",
            "screenshot": "help/catalog-api-key-step-2.png",
            "screenshotAlt": "API Keys page with Sandbox environment selected"
          },
          {
            "text": "Click Copy next to your Commerce Services API key",
            "screenshot": "help/catalog-api-key-step-3.png",
            "screenshotAlt": "API key row with Copy button highlighted"
          }
        ]
      },
      "group": "catalog-service"
    },
    "ADOBE_CATALOG_SERVICE_ENDPOINT": {
      "label": "Catalog Service Endpoint",
      "type": "url",
      "required": true,
      "default": "https://catalog-service-sandbox.adobe.io/graphql",
      "placeholder": "https://catalog-service-sandbox.adobe.io/graphql",
      "description": "Public Adobe service endpoint for Catalog Service and Live Search",
      "group": "catalog-service"
    },
    "ADOBE_COMMERCE_ADMIN_PASSWORD": {
      "label": "Admin Password",
      "type": "password",
      "required": true,
      "placeholder": "your_admin_password",
      "description": "Admin user must have API access permissions",
      "group": "adobe-commerce"
    },
    "ADOBE_COMMERCE_ADMIN_USERNAME": {
      "label": "Admin Username",
      "type": "text",
      "required": true,
      "placeholder": "admin",
      "description": "Admin user must have API access permissions",
      "group": "adobe-commerce"
    },
    "ADOBE_COMMERCE_CUSTOMER_GROUP": {
      "label": "Customer Group ID",
      "type": "text",
      "required": false,
      "default": "b6589fc6ab0dc82cf12099d1c2d40ab994e8410c",
      "description": "Leave as default for 'Not Logged In' group, or customize for specific pricing rules",
      "group": "adobe-commerce"
    },
    "ADOBE_COMMERCE_ENVIRONMENT_ID": {
      "label": "Environment ID",
      "type": "text",
      "required": true,
      "placeholder": "your-environment-id",
      "description": "Adobe Commerce Catalog Service dataspace identifier",
      "help": {
        "title": "Finding Your Environment ID",
        "steps": [
          {
            "text": "Open your Adobe Commerce Admin panel and navigate to System > Services > Commerce Services Connector",
            "screenshot": "help/environment-id-step-1.png",
            "screenshotAlt": "Commerce Admin navigation to Services"
          },
          {
            "text": "Look for the SaaS Identifier section",
            "screenshot": "help/environment-id-step-2.png",
            "screenshotAlt": "SaaS Identifier section in Commerce Services Connector"
          },
          {
            "text": "Copy the Data Space ID value - this is your Environment ID",
            "screenshot": "help/environment-id-step-3.png",
            "screenshotAlt": "Data Space ID field showing Environment ID value"
          }
        ]
      },
      "group": "catalog-service"
    },
    "ADOBE_COMMERCE_GRAPHQL_ENDPOINT": {
      "label": "Commerce GraphQL Endpoint",
      "type": "url",
      "required": true,
      "placeholder": "https://your-instance.adobedemo.com/graphql",
      "description": "The /graphql endpoint of your Commerce instance",
      "group": "adobe-commerce"
    },
    "ADOBE_COMMERCE_STORE_CODE": {
      "label": "Store Code",
      "type": "text",
      "required": true,
      "placeholder": "main_website_store",
      "description": "Usually 'main_website_store' for default Commerce installations",
      "group": "adobe-commerce"
    },
    "ADOBE_COMMERCE_STORE_VIEW_CODE": {
      "label": "Store View Code",
      "type": "text",
      "required": true,
      "placeholder": "default",
      "description": "Typically 'default' unless you have a custom store view setup",
      "group": "adobe-commerce"
    },
    "ADOBE_COMMERCE_URL": {
      "label": "Adobe Commerce URL",
      "type": "url",
      "required": true,
      "placeholder": "https://your-instance.adobedemo.com",
      "description": "Base URL shared across mesh, storefront, and integration services",
      "group": "adobe-commerce"
    },
    "ADOBE_COMMERCE_WEBSITE_CODE": {
      "label": "Website Code",
      "type": "text",
      "required": true,
      "placeholder": "base",
      "description": "Typically 'base' for single-website installations",
      "group": "adobe-commerce"
    },
    "AWS_ACCESS_KEY_ID": {
      "label": "AWS Access Key ID",
      "type": "text",
      "required": false,
      "placeholder": "your_aws_access_key_id",
      "description": "Only needed if your integration uses AWS S3 for asset storage",
      "group": "integration-service"
    },
    "AWS_SECRET_ACCESS_KEY": {
      "label": "AWS Secret Access Key",
      "type": "password",
      "required": false,
      "placeholder": "your_aws_secret_access_key",
      "description": "Pair this with your AWS Access Key ID for S3 access",
      "group": "integration-service"
    },
    "EXPERIENCE_PLATFORM_API_KEY": {
      "label": "Platform API Key",
      "type": "text",
      "required": true,
      "placeholder": "your-platform-api-key",
      "description": "Generate this in Adobe Developer Console for your Experience Platform project",
      "group": "experience-platform"
    },
    "EXPERIENCE_PLATFORM_DATASTREAM_ID": {
      "label": "Datastream ID",
      "type": "text",
      "required": true,
      "placeholder": "your-datastream-id",
      "description": "Create a datastream in the Adobe Experience Platform Data Collection UI",
      "group": "experience-platform"
    }
  }
}
