{
  "$schema": "./components.schema.json",
  "version": "1.0.0",
  "components": {
    "frontends": [
      {
        "id": "citisignal-nextjs",
        "name": "Headless CitiSignal",
        "description": "NextJS-based storefront with Adobe mesh integration",
        "version": "latest",
        "source": {
          "type": "git",
          "url": "https://github.com/skukla/citisignal-nextjs",
          "branch": "master"
        },
        "dependencies": {
          "required": ["commerce-mesh"],
          "optional": ["demo-inspector"]
        },
        "compatibleBackends": ["adobe-commerce-paas", "adobe-commerce-saas"],
        "configuration": {
          "envVars": [
            {
              "key": "MESH_ENDPOINT",
              "label": "API Mesh Endpoint",
              "type": "url",
              "required": true,
              "placeholder": "https://edge-sandbox-graph.adobe.io/api/your-mesh-id/graphql",
              "description": "The GraphQL endpoint for your Adobe API Mesh"
            },
            {
              "key": "ADOBE_COMMERCE_URL",
              "label": "Adobe Commerce URL",
              "type": "url",
              "required": true,
              "placeholder": "https://your-instance.adobedemo.com",
              "description": "Base URL of your Adobe Commerce instance"
            },
            {
              "key": "ADOBE_ASSETS_URL",
              "label": "Adobe Assets URL",
              "type": "url",
              "required": false,
              "placeholder": "https://delivery-p57319-e1619941.adobeaemcloud.com",
              "description": "URL for Adobe Experience Manager assets delivery"
            },
            {
              "key": "ADOBE_COMMERCE_ENVIRONMENT_ID",
              "label": "Environment ID",
              "type": "text",
              "required": true,
              "placeholder": "your-environment-id",
              "description": "Adobe Commerce environment identifier"
            },
            {
              "key": "ADOBE_COMMERCE_STORE_VIEW_CODE",
              "label": "Store View Code",
              "type": "text",
              "required": true,
              "default": "default",
              "description": "Store view code for multi-store setup"
            },
            {
              "key": "ADOBE_COMMERCE_WEBSITE_CODE",
              "label": "Website Code",
              "type": "text",
              "required": true,
              "default": "base",
              "description": "Website code for multi-website setup"
            },
            {
              "key": "ADOBE_COMMERCE_STORE_CODE",
              "label": "Store Code",
              "type": "text",
              "required": true,
              "default": "main_website_store",
              "description": "Store code identifier"
            },
            {
              "key": "ADOBE_CATALOG_API_KEY",
              "label": "Catalog Service API Key",
              "type": "text",
              "required": true,
              "placeholder": "your-catalog-service-staging-or-public-key",
              "description": "API key for Adobe Catalog Service (staging or production)"
            },
            {
              "key": "ADOBE_COMMERCE_CUSTOMER_GROUP",
              "label": "Customer Group ID",
              "type": "text",
              "required": false,
              "placeholder": "customer-group-id-hash",
              "description": "Customer group ID for price and catalog rules"
            },
            {
              "key": "USE_MESH",
              "label": "Use API Mesh",
              "type": "boolean",
              "required": false,
              "default": "true",
              "description": "Enable API Mesh for GraphQL operations"
            }
          ],
          "port": 3000,
          "nodeVersion": "24"
        },
        "features": [
          "Product Catalog",
          "Shopping Cart",
          "Checkout Flow",
          "Customer Account",
          "Search & Filters"
        ]
      }
    ],
    "backends": [
      {
        "id": "adobe-commerce-paas",
        "name": "Adobe Commerce PaaS",
        "description": "Adobe Commerce DSN instance",
        "configuration": {
          "nodeVersion": "20",
          "required": {
            "commerceUrl": {
              "type": "url",
              "label": "Commerce Instance URL",
              "placeholder": "https://your-instance.adobe.com"
            },
            "environmentId": {
              "type": "string",
              "label": "Environment ID",
              "placeholder": "your-environment-id"
            },
            "storeView": {
              "type": "string",
              "label": "Store View Code",
              "default": "default"
            },
            "storeCode": {
              "type": "string",
              "label": "Store Code",
              "default": "main_website_store"
            }
          },
          "services": [
            {
              "id": "catalog-service",
              "name": "Catalog Service",
              "description": "Enhanced product information management",
              "required": true,
              "endpoint": "https://catalog.adobe.io",
              "requiresApiKey": true
            },
            {
              "id": "live-search",
              "name": "Live Search",
              "description": "AI-powered search with personalization",
              "required": true,
              "endpoint": "https://search.adobe.io",
              "requiresApiKey": true
            }
          ]
        }
      }
    ],
    "dependencies": [
      {
        "id": "commerce-mesh",
        "name": "Adobe Commerce API Mesh",
        "description": "GraphQL gateway for unifying commerce data sources",
        "type": "mesh",
        "source": {
          "type": "git",
          "url": "https://github.com/skukla/commerce-mesh"
        },
        "configuration": {
          "nodeVersion": "20",
          "requiresDeployment": true,
          "deploymentTarget": "adobe-io",
          "envVars": [
            {
              "key": "ADOBE_COMMERCE_GRAPHQL_ENDPOINT",
              "label": "Commerce GraphQL Endpoint",
              "type": "url",
              "required": true,
              "placeholder": "https://your-instance.adobedemo.com/graphql",
              "description": "GraphQL endpoint of your Adobe Commerce instance"
            },
            {
              "key": "ADOBE_SANDBOX_CATALOG_SERVICE_ENDPOINT",
              "label": "Catalog Service Endpoint",
              "type": "select",
              "required": true,
              "default": "https://catalog-service-sandbox.adobe.io/graphql",
              "options": [
                { "value": "https://catalog-service-sandbox.adobe.io/graphql", "label": "Sandbox" },
                { "value": "https://catalog-service.adobe.io/graphql", "label": "Production" }
              ],
              "description": "Adobe Catalog Service endpoint (sandbox or production)"
            },
            {
              "key": "ADOBE_CATALOG_API_KEY",
              "label": "Catalog API Key",
              "type": "text",
              "required": true,
              "placeholder": "your_catalog_api_key_here",
              "description": "API key for Adobe Catalog Service"
            },
            {
              "key": "ADOBE_PRODUCTION_CATALOG_API_KEY",
              "label": "Production Catalog API Key",
              "type": "text",
              "required": false,
              "placeholder": "your_production_api_key_here",
              "description": "Production API key (if using production endpoint)"
            },
            {
              "key": "ADOBE_COMMERCE_ENVIRONMENT_ID",
              "label": "Environment ID",
              "type": "text",
              "required": true,
              "placeholder": "your_environment_id_here",
              "description": "Adobe Commerce environment identifier"
            },
            {
              "key": "ADOBE_COMMERCE_WEBSITE_CODE",
              "label": "Website Code",
              "type": "text",
              "required": true,
              "default": "base",
              "description": "Website code for API Mesh configuration"
            },
            {
              "key": "ADOBE_COMMERCE_STORE_CODE",
              "label": "Store Code",
              "type": "text",
              "required": true,
              "default": "main_website_store",
              "description": "Store code for API Mesh configuration"
            },
            {
              "key": "ADOBE_COMMERCE_STORE_VIEW_CODE",
              "label": "Store View Code",
              "type": "text",
              "required": true,
              "default": "default",
              "description": "Store view code for API Mesh configuration"
            }
          ]
        },
        "providesEndpoint": true
      },
      {
        "id": "demo-inspector",
        "name": "Demo Inspector",
        "description": "Visual debugging overlay showing data sources and API calls",
        "type": "inspector",
        "source": {
          "type": "npm",
          "package": "@adobe/demo-inspector",
          "version": "^1.0.0"
        },
        "configuration": {
          "defaultEnabled": true,
          "position": "right",
          "startOpen": false
        },
        "impact": "minimal",
        "removable": true
      }
    ],
    "externalSystems": [
      {
        "id": "experience-platform",
        "name": "Experience Platform",
        "description": "Adobe Experience Platform integration via Commerce Data Sharing",
        "requiresApiKey": true,
        "endpoint": "https://platform.adobe.io",
        "configuration": {
          "envVars": [
            {
              "key": "EXPERIENCE_PLATFORM_DATASTREAM_ID",
              "label": "Datastream ID",
              "type": "text",
              "required": true,
              "placeholder": "your-datastream-id",
              "description": "Adobe Experience Platform datastream identifier"
            },
            {
              "key": "EXPERIENCE_PLATFORM_API_KEY",
              "label": "Platform API Key",
              "type": "text",
              "required": true,
              "placeholder": "your-platform-api-key",
              "description": "API key for Adobe Experience Platform access"
            }
          ]
        }
      }
    ],
    "appBuilder": [
      {
        "id": "integration-service",
        "name": "Kukla Integration Service",
        "description": "Custom integration service for Target Product Recommendations, AEM Assets, and more",
        "source": {
          "type": "git",
          "url": "https://github.com/skukla/kukla-integration-service"
        },
        "requiresDeployment": true,
        "configuration": {
          "runtime": "nodejs:22",
          "nodeVersion": "22",
          "actions": ["browse-files", "get-products", "download-file", "delete-file"],
          "envVars": [
            {
              "key": "COMMERCE_BASE_URL",
              "label": "Commerce Base URL",
              "type": "url",
              "required": true,
              "placeholder": "https://your-commerce-instance.adobedemo.com",
              "description": "Base URL of your Adobe Commerce instance"
            },
            {
              "key": "COMMERCE_ADMIN_USERNAME",
              "label": "Admin Username",
              "type": "text",
              "required": true,
              "placeholder": "admin",
              "description": "Username for Commerce admin panel access"
            },
            {
              "key": "COMMERCE_ADMIN_PASSWORD",
              "label": "Admin Password",
              "type": "password",
              "required": true,
              "placeholder": "your_admin_password",
              "description": "Password for Commerce admin panel access"
            },
            {
              "key": "AWS_ACCESS_KEY_ID",
              "label": "AWS Access Key ID",
              "type": "text",
              "required": false,
              "placeholder": "your_aws_access_key_id",
              "description": "AWS access key for S3 integration (optional)"
            },
            {
              "key": "AWS_SECRET_ACCESS_KEY",
              "label": "AWS Secret Access Key",
              "type": "password",
              "required": false,
              "placeholder": "your_aws_secret_access_key",
              "description": "AWS secret key for S3 integration (optional)"
            }
          ]
        }
      }
    ]
  },
  "compatibilityMatrix": {
    "citisignal-nextjs": {
      "adobe-commerce-paas": {
        "compatible": true,
        "recommended": true,
        "notes": "Full feature support with all commerce capabilities"
      }
    }
  }
}