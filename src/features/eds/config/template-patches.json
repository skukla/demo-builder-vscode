{
    "$schema": "./template-patches.schema.json",
    "version": "1.0.0",
    "patches": [
        {
            "id": "header-nav-tools-defensive",
            "filePath": "blocks/header/header.js",
            "description": "Makes header.js defensive when nav-tools section is missing. DA.live strips empty divs during content processing, causing nav to have only 2 sections (brand, sections) instead of 3 (brand, sections, tools). Without this patch, header.js crashes with 'Cannot read properties of null'."
        },
        {
            "id": "aem-assets-sku-sanitization",
            "filePath": "scripts/__dropins__/tools/lib/aem/assets.js",
            "description": "Auto-sanitizes SKU aliases in AEM Assets URL generation. Product SKUs containing forward slashes (e.g., 'apple-iphone-se/iphone-se') create invalid URLs. This patch modifies makeAemAssetsImageSlot to replace slashes with dashes automatically, eliminating the need to patch 16+ individual block files."
        },
        {
            "id": "product-link-sku-encoding",
            "filePath": "scripts/commerce.js",
            "description": "URL-encodes SKUs in product links to handle special characters. Product SKUs containing forward slashes create invalid URLs with extra path segments, causing 404 errors. This patch modifies getProductLink to URL-encode SKUs and getSkuFromUrl to decode them."
        }
    ]
}
